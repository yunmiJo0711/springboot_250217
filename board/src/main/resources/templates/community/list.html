<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>커뮤니티 게시판 연습</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
<div class="container">
    <h1>Hello, world!</h1>
    <h3>List :</h3>
        <div>[[${requestDTO}]]</div>
        <div> totalCount: [[${pageList.totalCount}]] , totalPages: [[${pageList.totalPages}]],
            startPage: [[${pageList.startPage}]], endPage: [[${pageList.endPage}]]</div>
    <hr>
    <div class="row">
        <div class="col-auto">
            <a th:href="@{write}" class="btn btn-primary">글쓰기</a>
        </div>
    </div>
    <div class="row mt-3">
        <div class="card">
            <div class="card-header">
                <div class="card-title">커뮤니티</div>
            </div>
            <div class="card-body">
                <table class="table">
                    <thead>
                    <tr>
                        <th style="font-weight: 400;color: gray">번호</th>
                        <th>제목</th>
                        <th>작성자</th>
                        <th>작성날짜</th>
                        <th>조회수</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="dto : ${pageList.list}">
                        <td>[[${dto.idx}]]</td>
                        <td>
                            <!--검색 기능 : 글읽기 페이지에서 목록 클릭했을 때
                                           검색이 풀리면 안됩니다. 검색 페이지가 유지시켜주기 위함
                            -->
                            <a class="link-offset-2 link-underline link-underline-opacity-0"
                               th:href="|@{read?idx=}${dto.idx}&page=${page}|">[[${dto.title}]]</a>
                            <span class="badge" style="background-color: #bebebf;color:#6f42c1;font-size:0.7rem;">
                            	[[${dto.commentCount}]]</span>
                        </td>
                        <td>[[${dto.writer}]]</td>
                        <!-- <td>[[${dto.createdAt}]]</td> -->
                        <td>
                        <!-- 작성날짜를 yyyy-MM-dd 문자열로 변환해서 저장. -->
                        <th:block th:with="temp=${#dates.format(dto.createdAt,'yyyy-MM-dd')}">
							<!-- 오늘 이전에 작성한 글은 날짜로 표시. 문자열 비교 -->
							<span th:if="${#strings.equals(temp,today)}">
									[[${#dates.format(dto.createdAt,'HH:mm')}]]	
							</span>
							<span th:unless="${#strings.equals(temp,today)}"> <!-- 조건식이 거짓일 때  -->
									[[${temp}]]		
							</span>	
						</th:block>	
                        </td>
                        <td>[[${dto.readCount}]]</td>
                    </tr>
                    </tbody>
                </table>
                <div class="d-flex justify-content-center">
                    <ul class="pagination flex-wrap">
                        <li><a href="?page=1" class="btn">&lt;&lt;</a></li>
                        <li><a class="btn" th:href="|@{list?page=}${pageList.startPage-1}|"
                               th:style="${pageList.startPage==1 } ? 'display:none;' : ''">&lt;</a></li>
                        <li><span th:each="i : ${#numbers.sequence(pageList.startPage, pageList.endPage) }">
                             <a th:class="${page == i}? 'btn text-primary':'btn'" 
                             	th:href="|@{list?page=}${i}|">
                                 [[${i}]]</a>
                        	</span>
                        </li>
                        <li><a class="btn" th:href="|@{list?page=}${pageList.endPage+1}|"
                               th:style="${pageList.endPage>=pageList.totalPages } ? 'display:none;' : '' ">&gt;</a>
                        </li>
                        <li><a th:href="|@{list?page=}${pageList.totalPages}|" class="btn">&gt;&gt;</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>